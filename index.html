<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Test Form Gsheet</title>
  </head>
  <body>
    <h1>Test Form Gsheet xhr</h1>
    <form name="submit-to-google-sheet">
      <input name="email" type="email" placeholder="Email" required />
      <input name="name" type="text" placeholder="Name" required />
      <textarea name="message" placeholder="Message" required></textarea>
      <button type="submit">Send</button>
    </form>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const scriptURL = "https://script.google.com/macros/s/AKfycbzumVPz-83ImWAn8Aoq8cJVt_Hrqnj0KYCT-WAuH7wLYtj0WL1TOCJLaC2LEHSVQK0_CA/exec";
        const form = document.forms["submit-to-google-sheet"];

        form.addEventListener("submit", (e) => {
          e.preventDefault(); // Stop default submit behavior

          const xhr = new XMLHttpRequest();
          xhr.open("POST", scriptURL, true);
          xhr.onload = function () {
            if (xhr.status === 200) {
              alert("Success! Your form has been submitted.");
              form.reset();
            } else {
              alert("Error! Submission failed.");
            }
          };
          xhr.onerror = function () {
            alert("Network Error! Submission failed.");
          };
          xhr.send(new FormData(form));
        });
      });
    </script>
  </body>
</html>
